# SPDX-License-Identifier: Apache-2.0
# Copyright (c) 2020 Intel Corporation

## Custom FlexRAN flavor configuration
# CPUs to be isolated (for RT procesess)
# NOTE: If used for single node deployment please make sure that two cores are available to OS and K8s
cpu_isol: "1-23,25-47"
# CPUs not to be isolate (for non-RT processes) - minimum of two OS cores necessary for controller - adjust according to CPU model, HT enabled/disabled
cpu_os: "0,24"

## Kernel configuration
# Skip kernel configuration
# If true, kernel will not be installed.
# If false, package composed from variables kernel_package and kernel_version will be installed together with it's devel
kernel_skip: false

# Version of the kernel.
kernel_version: 3.10.0-1127.19.1.rt56.1116.el7.x86_64

## Tuned configuration
# Skip tuned configuration
# If true, tuned will not be configured
# If false, tuned_packages will be installed, tuned_profile will be applied with tuned_vars
tuned_skip: true

tuned_repo_addr: "{{ hostvars[groups['controller_group'][0]]['ansible_host'] if offline_enable else 'linuxsoft.cern.ch/scientific/7x/x86_64/os/Packages' }}"

tuned_packages:
  - "http://{{ tuned_repo_addr }}/tuned-2.11.0-8.el7.noarch.rpm"
  - "http://{{ tuned_repo_addr }}/tuned-profiles-realtime-2.11.0-8.el7.noarch.rpm"

## GRUB configuration
# Size of a single hugepage (2M or 1G)
hugepage_size: "1G"
# Amount of hugepages
hugepage_amount: "20"
# Default grub parameters
default_grub_params: "default_hugepagesz={{ hugepage_size }} hugepagesz={{ hugepage_size }} hugepages={{ hugepage_amount }} intel_iommu=on iommu=pt rdt=l3cat"
# Additional grub parameters
additional_grub_params: "selinux=0 enforcing=0 nmi_watchdog=0 softlockup_panic=0 intel_pstate=disable mce=off idle=poll
 isolcpus={{ cpu_isol }} rcu_nocbs={{ cpu_isol }} kthread_cpus={{ cpu_os }} irqaffinity={{ cpu_os }} nohz_full={{ cpu_isol }}"

