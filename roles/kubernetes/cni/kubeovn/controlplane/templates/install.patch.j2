diff --git a/install.sh b/install.sh
index c342667..5d12651 100644
--- a/install.sh
+++ b/install.sh
@@ -709,11 +709,11 @@ spec:
           resources:
             requests:
               cpu: 500m
-              memory: 2Gi
+              memory: {{ kubeovn_dpdk_resources_requests }}
             limits:
               cpu: 1000m
-              memory: 2Gi
-              hugepages-1Gi: 1Gi
+              memory: {{ kubeovn_dpdk_resources_limits }}
+              hugepages-{{ kubeovn_dpdk_hugepage_size }}: {{ kubeovn_dpdk_hugepages }}
       nodeSelector:
         kubernetes.io/os: "linux"
       volumes:
@@ -1848,7 +1848,16 @@ echo "-------------------------------"
 echo ""

 echo "[Step 6] Run network diagnose"
-kubectl ko diagnose all
+
+retries=0
+while [[ $retries -lt {{ number_of_retries }} ]]; do
+  if kubectl ko diagnose all; then
+    break;
+ fi
+
+  retries=$((retries + 1))
+  sleep {{ retry_delay }}
+done

 echo "-------------------------------"
 echo ""
